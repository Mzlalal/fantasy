<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, initial-scale=1.0, user-scalable=no"
          name="viewport">
    <title>åŠŸèƒ½åˆ—è¡¨</title>
    <meta content="å°ºå¢¨é£è™¹" name="apple-mobile-web-app-title">
    <link href="ignore/oss-images/apple-bookmark.png" rel="apple-touch-icon">
    <link href="ignore/oss-images/apple-bookmark.png" rel="apple-touch-icon" sizes="76x76">
    <link href="ignore/oss-images/apple-bookmark.png" rel="apple-touch-icon" sizes="120x120">
    <link href="ignore/oss-images/apple-bookmark.png" rel="apple-touch-icon" sizes="152x152">
    <link href="ignore/oss-images/apple-bookmark.png" rel="apple-touch-icon-precomposed" sizes="152x152">
    <link href="https://static-4518.obs.cn-south-1.myhuaweicloud.com/frozen.css" rel="stylesheet"/>
    <link href="css/common.css" rel="stylesheet"/>
    <script src="https://static-4518.obs.cn-south-1.myhuaweicloud.com/axios.min.js"></script>
    <script src="https://static-4518.obs.cn-south-1.myhuaweicloud.com/vue.min.js"></script>
    <script src="js/CommonUtil.js"></script>
    <script src="js/FantasyConstant.js"></script>
    <script src="js/components/PopupMenu.js"></script>
</head>
<style>
    body {
        margin: 0;
        font-family: 'Arial', sans-serif;
        min-height: 100vh;
    }

    .ui-img-vertical {
        padding-top: 100%;
        position: relative;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 15px;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
        overflow: hidden;
    }

    .ui-img-vertical:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        background: rgba(255, 255, 255, 0.15);
    }

    .ui-img-vertical span {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 24px;
        filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.3));
    }
    
    .ui-form {
        background-color: unset;
    }

    .ui-border-b:before {
        border-bottom: unset;
    }

    .ui-grid-info {
        padding: 10px 0px;
        text-align: center;
    }

    .ui-grid-info span {
        font-weight: 600;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
        font-size: 14px;
    }

    .ui-container {
        padding: 20px;
        max-width: 1200px;
        margin: 0 auto;
    }

    .ui-whitespace li {
        margin-bottom: 15px;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
    }

    .ui-whitespace li:hover {
        transform: scale(1.02);
    }

    .ui-header {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .ui-header span {
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }

    .username-display {
        cursor: pointer;
        padding: 10px;
        border-radius: 10px;
        transition: background 0.3s ease;
    }

    .username-display:hover {
        background: rgba(255, 255, 255, 0.1);
    }

    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
        .ui-container {
            padding: 10px;
        }

        .ui-whitespace li {
            margin-bottom: 10px;
        }

        .ui-img-vertical span {
            font-size: 20px;
        }
    }

    /* åŠ¨ç”»æ•ˆæœ */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .ui-whitespace li {
        animation: fadeInUp 0.6s ease-out;
        animation-fill-mode: both;
    }

    .ui-grid-trisect>ul li {
        width: 29.3333%;
        margin: 15px 3px;
    }

    .ui-whitespace li:nth-child(1) { animation-delay: 0.1s; }
    .ui-whitespace li:nth-child(2) { animation-delay: 0.2s; }
    .ui-whitespace li:nth-child(3) { animation-delay: 0.3s; }
    .ui-whitespace li:nth-child(4) { animation-delay: 0.4s; }
    .ui-whitespace li:nth-child(5) { animation-delay: 0.5s; }
    .ui-whitespace li:nth-child(6) { animation-delay: 0.6s; }
    .ui-whitespace li:nth-child(7) { animation-delay: 0.7s; }
    .ui-whitespace li:nth-child(8) { animation-delay: 0.8s; }
    .ui-whitespace li:nth-child(9) { animation-delay: 0.9s; }
    .ui-whitespace li:nth-child(10) { animation-delay: 1.0s; }
</style>
<body>
<div id="app">
    <header class="ui-header ui-header-positive ui-border-b text-center">
        <span @click="menuShow = true" class="position-left username-display">æˆ‘çš„èœå•</span>
        <span class="font-weight-bolder font-size-20px">Fantasy</span>
    </header>
    <div class="ui-form ui-border-t ui-container">
        <div class="ui-grid ui-grid-trisect">
            <ul class="ui-border-b ui-whitespace">
                <li @click="redirectClientIndex(client.indexUri)" v-for="client in clientList"
                    v-if="!hideList.includes(client.clientKey)">
                    <div class="ui-img-vertical">
                        <span style="font-size: 20cqw; text-align: center;">{{client.emoji}}</span>
                    </div>
                    <div class="ui-grid-info text-center">
                        <span class="font-weight-bolder">{{client.clientName}}</span>
                    </div>
                </li>
            </ul>
        </div>
    </div>

    <template-popup-menu :menu-show="menuShow" @on-close="menuShow = false"></template-popup-menu>
</div>
</body>
<script>
    new Vue({
        el: "#app",
        data() {
            return {
                // èœå•æ˜¾ç¤º
                menuShow: false,
                // å®¢æˆ·ç«¯åˆ—è¡¨
                clientList: [],
                // éœ€è¦éšè—çš„å®¢æˆ·ç«¯
                hideList: [],
                // emojié›†åˆ
                emojiSets: [
                    ['ğŸ˜€', 'ğŸ˜', 'ğŸ˜‚', 'ğŸ¤£', 'ğŸ˜ƒ', 'ğŸ˜„', 'ğŸ˜…', 'ğŸ˜†', 'ğŸ˜‰', 'ğŸ˜Š', 'ğŸ˜‹', 'ğŸ˜', 'ğŸ˜', 'ğŸ˜˜', 'ğŸ˜—', 'ğŸ˜™', 'ğŸ˜š', 'ğŸ™‚', 'ğŸ¤—', 'ğŸ¤©'],
                    ['ğŸ', 'ğŸŒ', 'ğŸ‰', 'ğŸ‡', 'ğŸ“', 'ğŸ’', 'ğŸ‘', 'ğŸ', 'ğŸ¥', 'ğŸ…', 'ğŸ¥‘', 'ğŸ†', 'ğŸ¥•', 'ğŸŒ½', 'ğŸ¥”', 'ğŸ ', 'ğŸ¥–', 'ğŸ¥¨', 'ğŸ§€'],
                    ['ğŸ¶', 'ğŸ±', 'ğŸ­', 'ğŸ¹', 'ğŸ°', 'ğŸ¦Š', 'ğŸ»', 'ğŸ¼', 'ğŸ¨', 'ğŸ¯', 'ğŸ¦', 'ğŸ¸', 'ğŸµ', 'ğŸ§', 'ğŸ¦', 'ğŸ¤', 'ğŸ£', 'ğŸ¥', 'ğŸ¦†'],
                    ['ğŸš—', 'ğŸš•', 'ğŸš™', 'ğŸšŒ', 'ğŸš', 'ğŸï¸', 'ğŸš“', 'ğŸš‘', 'ğŸš’', 'ğŸš', 'ğŸšš', 'ğŸš›', 'ğŸšœ', 'ğŸï¸', 'ğŸ›µ', 'ğŸš²', 'ğŸ›¹', 'ğŸš', 'âœˆï¸'],
                    ['ğŸ¨', 'ğŸ­', 'ğŸª', 'ğŸ§', 'ğŸ¼', 'ğŸ¹', 'ğŸ¥', 'ğŸ·', 'ğŸº', 'ğŸª—', 'ğŸ¸', 'ğŸª•', 'ğŸ»', 'ğŸ²', 'â™ ï¸', 'â™¥ï¸', 'â™¦ï¸', 'â™£ï¸'],
                    ['ğŸŒŸ', 'â­', 'ğŸŒ™', 'â˜€ï¸', 'ğŸŒˆ', 'â˜ï¸', 'â„ï¸', 'âš¡', 'ğŸŒŠ', 'ğŸ”¥', 'ğŸŒ¸', 'ğŸŒº', 'ğŸŒ»', 'ğŸŒ¹', 'ğŸŒ·', 'ğŸŒ¼', 'ğŸ€', 'ğŸ„', 'ğŸŒ²'],
                    ['ğŸ ', 'ğŸ¡', 'ğŸ¢', 'ğŸ£', 'ğŸ¤', 'ğŸ¥', 'ğŸ¦', 'ğŸ¨', 'ğŸ©', 'ğŸª', 'ğŸ«', 'ğŸ¬', 'ğŸ­', 'ğŸ¯', 'ğŸ°', 'ğŸ’’', 'ğŸ—¼', 'ğŸ—½', 'â›ª', 'ğŸ•Œ'],
                ],
            }
        },
        computed: {
            // è®¡ç®—éœ€è¦æ˜¾ç¤ºçš„å®¢æˆ·ç«¯åˆ—è¡¨
            visibleClients() {
                return this.clientList.filter(client => !this.hideList.includes(client.clientKey));
            }
        },
        watch: {
            // ç›‘å¬å¯è§å®¢æˆ·ç«¯åˆ—è¡¨å˜åŒ–ï¼Œé‡æ–°åˆ†é…emoji
            visibleClients: {
                handler(newVal, oldVal) {
                    if (newVal && newVal.length > 0) {
                        this.regenerateEmojis();
                    }
                },
                immediate: true, // ç»„ä»¶åˆ›å»ºæ—¶ç«‹å³æ‰§è¡Œä¸€æ¬¡
                deep: true
            }
        },
        methods: {
            // è·³è½¬åˆ°å®¢æˆ·ç«¯é¦–é¡µ
            redirectClientIndex(indexUri) {
                // è·³è½¬
                window.location = (indexUri.startsWith("http") ? "" : gateway) + indexUri;
            },
            // ä¸ºå®¢æˆ·ç«¯é‡æ–°ç”Ÿæˆemojiï¼ˆç¡®ä¿ä¸é‡å¤ï¼‰
            regenerateEmojis() {
                // é€‰æ‹©ä¸€ä¸ªåŒ…å«è¶³å¤Ÿemojiçš„é›†åˆ
                let selectedEmojiSet = null;
                let attempts = 0;
                const maxAttempts = 10; // æœ€å¤šå°è¯•10æ¬¡é€‰æ‹©åˆé€‚çš„é›†åˆ

                while (!selectedEmojiSet && attempts < maxAttempts) {
                    const randomSetIndex = Math.floor(Math.random() * this.emojiSets.length);
                    const emojiSet = this.emojiSets[randomSetIndex];
                    if (emojiSet.length >= this.visibleClients.length) {
                        selectedEmojiSet = [...emojiSet]; // å¤åˆ¶æ•°ç»„ï¼Œé¿å…ä¿®æ”¹åŸæ•°ç»„
                    }
                    attempts++;
                }

                // å¦‚æœæ‰¾ä¸åˆ°åˆé€‚çš„é›†åˆï¼Œä½¿ç”¨ç¬¬ä¸€ä¸ªé›†åˆï¼ˆå³ä½¿å¯èƒ½é‡å¤ï¼‰
                if (!selectedEmojiSet) {
                    selectedEmojiSet = [...this.emojiSets[0]];
                }

                // ä¸ºæ¯ä¸ªå®¢æˆ·ç«¯åˆ†é…å”¯ä¸€çš„emoji
                this.visibleClients.forEach((client, index) => {
                    if (selectedEmojiSet.length > 0) {
                        const randomIndex = Math.floor(Math.random() * selectedEmojiSet.length);
                        client.emoji = selectedEmojiSet.splice(randomIndex, 1)[0]; // ä»æ•°ç»„ä¸­ç§»é™¤å·²ä½¿ç”¨çš„emoji
                    } else {
                        // å¦‚æœemojiä¸å¤Ÿç”¨ï¼Œä½¿ç”¨é»˜è®¤emoji
                        client.emoji = 'ğŸ¯';
                    }
                });
            }
        },
        created() {
            // è·å–ç”¨æˆ·ä¿¡æ¯
            let userInfo = commonUtil.getUserInfo();
            // è·å–ç”¨æˆ·å®¢æˆ·ç«¯
            this.clientList = userInfo.clientList;
            // ä¸ºå®¢æˆ·ç«¯åˆ†é…emoji
            this.regenerateEmojis();
        }
    });
</script>

</html>
